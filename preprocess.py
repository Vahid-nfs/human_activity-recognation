import pandas as pd import numpy as npimport matplotlib.pyplot as plt from glob import globfrom tqdm import tqdmimport osos.makedirs("./dataset",exist_ok=True)A_key=pd.read_csv("./wisdm-dataset/activity_key.txt",sep=" = ",names=["activity","key"])key_activity_dict=dict(zip(A_key.key,A_key.activity))p_path="./wisdm-dataset/raw/phone"w_path="./wisdm-dataset/raw/watch"PA=sorted(glob(f"{p_path}/accel/*.txt"))PG=sorted(glob(f"{p_path}/gyro/*.txt"))WA=sorted(glob(f"{w_path}/accel/*.txt"))WG=sorted(glob(f"{w_path}/gyro/*.txt"))def read_data(A_paths,G_paths):    t_df=pd.DataFrame(columns=["Subject_id","Activity","Timestamp","XA","YA","ZA","XG","YG","ZG"])    assert len(A_paths)==len(G_paths)    for i in tqdm(range(len(A_paths))):        df1=pd.read_csv(A_paths[i],names=["Subject_id","Activity","Timestamp","XA","YA","ZA"]).drop_duplicates(["Timestamp"]).drop(columns=["Subject_id","Activity"]).set_index(["Timestamp"])        df2=pd.read_csv(G_paths[i],names=["Subject_id","Activity","Timestamp","XG","YG","ZG"]).drop_duplicates(["Timestamp"]).set_index(["Timestamp"])        df=pd.concat((df1,df2),axis=1).dropna().reset_index()        t_df=pd.concat((t_df,df))    t_df["ZG"]=t_df["ZG"].apply(lambda x : x.strip(";"))    t_df["ZG"]=np.float64(t_df["ZG"])    t_df["ZA"]=t_df["ZA"].apply(lambda x : x.strip(";"))    t_df["ZA"]=np.float64(t_df["ZA"])    t_df["Activity_name"]=t_df["Activity"].replace(key_activity_dict)    t_df=t_df.sort_values(["Subject_id","Activity","Timestamp"],ignore_index=True)    return t_df    P_df=read_data(PA,PG)# P_df.to_csv("./dataset/phone.csv")P_df.to_pickle("./dataset/phone.pkl")  W_df=read_data(WA,WG)# W_df.to_csv("./dataset/watch.csv")W_df.to_pickle("./dataset/watch.pkl") 